# Monster Stat Block System

## What This Does

This contribution implements a comprehensive monster stat block system based on D&D 5e. It provides:

- **Complete Stat Blocks**: Full D&D 5e stat blocks for all monsters generated by procedural systems
- **Theme Organization**: Monsters organized by dungeon theme
- **XP Rewards**: Automatic XP calculation based on Challenge Rating (CR)
- **Combat Integration**: Ready-to-use stat blocks for combat encounters
- **Monster Registry**: Centralized registry of all available monsters

## Where It Should Be Integrated

### Type Definitions
- `packages/lib/src/types/monster-stats.ts` - New file with monster stat block types
- `packages/lib/src/index.ts` - Export new types

### Monster Data
- `apps/web/lib/data/monster-registry.ts` - Monster stat block data (or integrate into existing data structure)
- `apps/web/lib/services/monsterService.ts` - Service for retrieving monster stat blocks

### Integration Points
- `packages/engine/src/combat.ts` - Use monster stat blocks for combat encounters
- `apps/web/contributions/themed-dungeon-generation/` - Link theme monsters to stat blocks
- `apps/web/lib/game-mechanics/monsters/MonsterFactory.ts` - Replace with stat block system
- `apps/web/contributions/adventurer-tracking/` - Award XP based on monster CR

### API Endpoints (Optional)
- `apps/web/app/api/monsters/route.ts` - Get monster stat blocks
- `apps/web/app/api/monsters/[name]/route.ts` - Get specific monster stat block
- `apps/web/app/api/monsters/theme/[theme]/route.ts` - Get monsters by theme

## How to Test

### Unit Tests
1. Test monster stat block retrieval by name
2. Test monster retrieval by theme
3. Test XP calculation from CR
4. Test monster instance creation
5. Test attack bonus calculations
6. Test damage calculations

### Integration Tests
1. Create combat encounter with monster stat blocks
2. Award XP based on monster CR
3. Test monster selection by theme in dungeon generation
4. Verify stat blocks match D&D 5e Monster Manual

### Manual Testing
1. Query monster stat block by name
2. Get all monsters for a theme
3. Create monster instance for combat
4. Calculate XP reward for defeating monster
5. Verify stat blocks are complete and accurate

## Dependencies

- D&D 5e Monster Manual (for stat block data)
- Adventurer tracking system (for XP awards)
- Themed dungeon generation system (for theme integration)

## Breaking Changes

None - this is an additive feature. Existing monster systems can be gradually migrated to use stat blocks.

## Design Decisions

1. **D&D 5e Based**: All stat blocks follow D&D 5e Monster Manual format for consistency and familiarity.

2. **Challenge Rating (CR)**: Monsters use D&D 5e Challenge Rating system for balance and XP calculation.

3. **XP Rewards**: XP is automatically calculated from CR using D&D 5e XP table.

4. **Theme Organization**: Monsters are organized by dungeon theme to match procedural generation.

5. **Stat Block Completeness**: Stat blocks include all necessary combat information:
   - Ability scores and modifiers
   - Armor class and hit points
   - Speed and movement types
   - Actions and attacks
   - Special traits and abilities
   - Damage resistances/immunities
   - Senses and languages

6. **Monster Instances**: Stat blocks are used to create monster instances for combat with current HP tracking.

## Code Structure

```
contributions/monster-stat-blocks/
Γö£ΓöÇΓöÇ README.md (this file)
Γö£ΓöÇΓöÇ code/
Γöé   Γö£ΓöÇΓöÇ types/
Γöé   Γöé   ΓööΓöÇΓöÇ monster-stats.ts        # Stat block types and interfaces
Γöé   Γö£ΓöÇΓöÇ data/
Γöé   Γöé   ΓööΓöÇΓöÇ monster-registry.ts     # All monster stat blocks
Γöé   ΓööΓöÇΓöÇ services/
Γöé       ΓööΓöÇΓöÇ monsterService.ts       # Service for retrieving stat blocks
ΓööΓöÇΓöÇ examples/
    ΓööΓöÇΓöÇ usage-examples.ts           # Code examples showing integration
```

## Monster List

### Undead Theme
- Skeleton, Zombie, Wraith, Ghost, Lich, Banshee, Death Knight, Mummy

### Fire Theme
- Fire Elemental, Lava Golem, Salamander, Fire Imp, Magma Beast, Phoenix, Hellhound

### Ice Theme
- Ice Elemental, Frost Giant, Ice Golem, Frozen Wraith, Yeti, Ice Wyrm, Frost Troll

### Nature Theme
- Ent, Treant, Giant Spider, Venomous Plant, Beast, Druid, Wild Boar, Dire Wolf

### Shadow Theme
- Shadow, Dark Stalker, Void Creature, Shadow Demon, Dark Mage, Nightmare, Phantom

### Mechanical Theme
- Golem, Construct, Mechanical Spider, Automaton, Clockwork Beast, War Machine, Steel Guardian

### Abyssal Theme
- Demon, Imp, Hellhound, Succubus, Balrog, Fiend, Chaos Spawn

### Crystal Theme
- Crystal Golem, Arcane Construct, Crystal Spider, Mana Elemental, Crystal Beast, Arcane Guardian

### Bandit Theme
- Bandit, Bandit Veteran, Bandit Leader, Thug, Mercenary, Outlaw, Raider, Cutthroat

### Goblin Theme
- Goblin, Goblin Warrior, Goblin Shaman, Hobgoblin, Bugbear, Cave Rat, Giant Bat, Dire Weasel

### Necromancer Tower Theme
- Skeleton, Zombie, Animated Golem, Mimic, Black Dragon, Cultist, Dark Acolyte, Wight

### Generic
- Goblin, Skeleton, Orc, Spider, Bandit (regular)
- Dragon, Lich, Giant, Demon (bosses)

## Integration Example

```typescript
// Get monster stat block
import { getMonsterStatBlock, createMonsterInstance } from '@/lib/services/monsterService';

const statBlock = getMonsterStatBlock('Skeleton');
if (statBlock) {
  const monster = createMonsterInstance(statBlock);
  
  // Use in combat
  console.log(`Monster: ${monster.statBlock.name}`);
  console.log(`HP: ${monster.currentHp}/${monster.maxHp}`);
  console.log(`AC: ${monster.statBlock.armorClass}`);
  console.log(`XP Reward: ${monster.statBlock.xpReward}`);
}

// Get monsters by theme
import { getMonsterStatBlocksByTheme } from '@/lib/services/monsterService';

const undeadMonsters = getMonsterStatBlocksByTheme('undead');
console.log(`Found ${undeadMonsters.length} undead monsters`);

// Award XP after combat
import { getMonsterXPReward } from '@/lib/services/monsterService';
import { updateAdventurerStats } from '@/lib/services/adventurerService';

const xpReward = getMonsterXPReward(statBlock);
// Add XP to adventurer (implementation depends on XP tracking system)
```

## Notes

- **Stat Block Data**: The current implementation includes basic stat blocks. The user should fill in complete D&D 5e stat blocks from the Monster Manual for all monsters.

- **Actions and Traits**: Full stat blocks should include:
  - All actions with attack bonuses and damage
  - Special traits and abilities
  - Legendary actions (for bosses)
  - Reactions
  - Spellcasting (if applicable)

- **Damage Types**: Stat blocks should specify damage types for resistances, immunities, and vulnerabilities.

- **Scaling**: For higher-level encounters, monsters can be scaled by adjusting CR, HP, and damage while maintaining the base stat block structure.

- **Boss Monsters**: Boss monsters typically have:
  - Higher CR
  - Legendary actions
  - More HP
  - Special abilities
  - Higher XP rewards